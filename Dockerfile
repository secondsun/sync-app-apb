FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvc3luYy1hcHAuaHRtbCIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiAKICAgICAgbW9iaWxlY2xp\
ZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3t9JwogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9ET0NLRVJfSU1BR0UKICAgICAgICBkZXNjcmlwdGlvbjog\
VVJMIG9mIHlvdXIgU3luYyBBcHBsaWNhdGlvbiBEb2NrZXIgSW1hZ2UsIGUuZy4gZG9ja2VyLmlv\
L2Flcm9nZWFyL3ZveWFnZXItc2VydmVyLWV4YW1wbGUtdGFzawogICAgICAgIHR5cGU6IHN0cmlu\
ZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24g\
RG9ja2VyIGltYWdlCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfRE9DS0VSX0lNQUdFX1ZFUlNJT04K\
ICAgICAgICBkZXNjcmlwdGlvbjogVmVyc2lvbiBvZiB5b3VyIFN5bmMgQXBwbGljYXRpb24gRG9j\
a2VyIEltYWdlICh1c2luZyAnbGF0ZXN0JyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxp\
Y2F0aW9uIERvY2tlciBpbWFnZSB2ZXJzaW9uCiAgICAgIC0gbmFtZTogU1lOQ19BUFBfSEVBTFRI\
X0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246IEhlYWx0aCBFbmRwb2ludCBvZiB5b3VyIFN5\
bmMgQXBwbGljYXRpb24gKHVzaW5nICcvJyBpZiBub3Qgc3BlY2lmaWVkKQogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICAgIHRpdGxlOiBTeW5jIEFwcGxp\
Y2F0aW9uIGhlYWx0aCBlbmRwb2ludAogICAgICAtIG5hbWU6IFNZTkNfQVBQX1BPUlQKICAgICAg\
ICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0aGUgU3luYyBBcHBsaWNhdGlvbiB0byBFeHBvc2UKICAg\
ICAgICB0eXBlOiBudW1iZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBT\
eW5jIEFwcCBQb3J0CiAgICAgIC0gbmFtZTogU1lOQ19BUFBfR1JBUEhRTF9FTkRQT0lOVAogICAg\
ICAgIGRlc2NyaXB0aW9uOiBHcmFwaFFMIEVuZHBvaW50IG9mIHlvdXIgU3luYyBBcHBsaWNhdGlv\
biAodXNpbmcgJ2dyYXBocWwnIGlmIG5vdCBzcGVjaWZpZWQpCiAgICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwIEdyYXBoUUwg\
RW5kcG9pbnQKICAgICAgLSBuYW1lOiBEQl9IT1NUTkFNRQogICAgICAgIGRlc2NyaXB0aW9uOiBI\
b3N0bmFtZSBvZiB0aGUgU1FMIFNlcnZlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJl\
cXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgSG9zdG5hbWUKICAgICAgLSBu\
YW1lOiBEQl9QT1JUCiAgICAgICAgZGVzY3JpcHRpb246IFBvcnQgb2YgdGhlIFNRTCBTZXJ2ZXIK\
ICAgICAgICB0eXBlOiBudW1iZXIKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxl\
OiBTUUwgU2VydmVyIFBvcnQKICAgICAgLSBuYW1lOiBEQl9VU0VSTkFNRQogICAgICAgIGRlc2Ny\
aXB0aW9uOiBVc2VybmFtZSB0aGF0IHdpbGwgYmUgdXNlZCB0byBjb25uZWN0IHRvIERhdGFiYXNl\
CiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRs\
ZTogU1FMIFNlcnZlciBVc2VybmFtZQogICAgICAtIG5hbWU6IERCX1BBU1NXT1JECiAgICAgICAg\
ZGVzY3JpcHRpb246IFBhc3N3b3JkIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3QgdG8gRGF0\
YWJhc2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAg\
IHRpdGxlOiBTUUwgU2VydmVyIFBhc3N3b3JkCiAgICAgIC0gbmFtZTogREJfTkFNRQogICAgICAg\
IGRlc2NyaXB0aW9uOiBOYW1lIG9mIHRoZSBTUUwgU2VydmVyJ3MgZGF0YWJhc2UKICAgICAgICB0\
eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBEYXRhYmFz\
ZSBuYW1lCiAgICAgIC0gbmFtZTogREJfU1NMCiAgICAgICAgZGVzY3JpcHRpb246IFVzZSBTU0wg\
Y29ubmVjdGlvbiB0byBTUUwgU2VydmVyCiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAgIGRp\
c3BsYXlfdHlwZTogY2hlY2tib3gKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIHRpdGxl\
OiBVc2UgU1NMPwogICAgYmluZF9wYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IENMSUVOVF9JRAog\
ICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IE1vYmlsZSBDbGllbnQgSUQKICAg\
ICAgICB0eXBlOiBzdHJpbmcKICAgICAgICAK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
