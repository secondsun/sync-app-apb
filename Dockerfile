FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcCA5CiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNv\
bkNsYXNzOiBmYSBmYS1yZWZyZXNoCiAgI2RvY3VtZW50YXRpb25Vcmw6ICJodHRwczovL2RvY3Mu\
YWVyb2dlYXIub3JnL2V4dGVybmFsL2FwYi9zeW5jLWFwcC5odG1sIgogIHByb3ZpZGVyRGlzcGxh\
eU5hbWU6ICJSZWQgSGF0LCBJbmMuIgogIHNlcnZpY2VOYW1lOiBzeW5jLWFwcApwbGFuczoKICAt\
IG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIHBsYW4gc2V0cyB1cCB0aGUgU3lu\
YyBBcHBsaWNhdGlvbgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6IAogICAgICBtb2JpbGVj\
bGllbnRfYmluZF9wYXJhbWV0ZXJzX2RhdGE6CiAgICAgICAgLSAne30nCiAgICBwYXJhbWV0ZXJz\
OgogICAgICAtIG5hbWU6IFNZTkNfQVBQX0RPQ0tFUl9JTUFHRQogICAgICAgIGRlc2NyaXB0aW9u\
OiBVUkwgb2YgeW91ciBTeW5jIEFwcGxpY2F0aW9uIERvY2tlciBJbWFnZSwgZS5nLiBkb2NrZXIu\
aW8vYWVyb2dlYXIvdm95YWdlci1zZXJ2ZXItZXhhbXBsZS10YXNrCiAgICAgICAgdHlwZTogc3Ry\
aW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogU3luYyBBcHBsaWNhdGlv\
biBEb2NrZXIgaW1hZ2UKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9ET0NLRVJfSU1BR0VfVkVSU0lP\
TgogICAgICAgIGRlc2NyaXB0aW9uOiBWZXJzaW9uIG9mIHlvdXIgU3luYyBBcHBsaWNhdGlvbiBE\
b2NrZXIgSW1hZ2UgKHVzaW5nICdsYXRlc3QnIGlmIG5vdCBzcGVjaWZpZWQpCiAgICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBw\
bGljYXRpb24gRG9ja2VyIGltYWdlIHZlcnNpb24KICAgICAgLSBuYW1lOiBTWU5DX0FQUF9IRUFM\
VEhfRU5EUE9JTlQKICAgICAgICBkZXNjcmlwdGlvbjogSGVhbHRoIEVuZHBvaW50IG9mIHlvdXIg\
U3luYyBBcHBsaWNhdGlvbiAodXNpbmcgJy8nIGlmIG5vdCBzcGVjaWZpZWQpCiAgICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBw\
bGljYXRpb24gaGVhbHRoIGVuZHBvaW50CiAgICAgIC0gbmFtZTogU1lOQ19BUFBfUE9SVAogICAg\
ICAgIGRlc2NyaXB0aW9uOiBQb3J0IG9mIHRoZSBTeW5jIEFwcGxpY2F0aW9uIHRvIEV4cG9zZQog\
ICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6\
IFN5bmMgQXBwIFBvcnQKICAgICAgLSBuYW1lOiBTWU5DX0FQUF9HUkFQSFFMX0VORFBPSU5UCiAg\
ICAgICAgZGVzY3JpcHRpb246IEdyYXBoUUwgRW5kcG9pbnQgb2YgeW91ciBTeW5jIEFwcGxpY2F0\
aW9uICh1c2luZyAnZ3JhcGhxbCcgaWYgbm90IHNwZWNpZmllZCkKICAgICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHAgR3JhcGhR\
TCBFbmRwb2ludAogICAgICAtIG5hbWU6IERCX0hPU1ROQU1FCiAgICAgICAgZGVzY3JpcHRpb246\
IEhvc3RuYW1lIG9mIHRoZSBTUUwgU2VydmVyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAg\
cmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogU1FMIFNlcnZlciBIb3N0bmFtZQogICAgICAt\
IG5hbWU6IERCX1BPUlQKICAgICAgICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0aGUgU1FMIFNlcnZl\
cgogICAgICAgIHR5cGU6IG51bWJlcgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0\
bGU6IFNRTCBTZXJ2ZXIgUG9ydAogICAgICAtIG5hbWU6IERCX1VTRVJOQU1FCiAgICAgICAgZGVz\
Y3JpcHRpb246IFVzZXJuYW1lIHRoYXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3QgdG8gRGF0YWJh\
c2UKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRp\
dGxlOiBTUUwgU2VydmVyIFVzZXJuYW1lCiAgICAgIC0gbmFtZTogREJfUEFTU1dPUkQKICAgICAg\
ICBkZXNjcmlwdGlvbjogUGFzc3dvcmQgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29ubmVjdCB0byBE\
YXRhYmFzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAg\
ICAgdGl0bGU6IFNRTCBTZXJ2ZXIgUGFzc3dvcmQKICAgICAgLSBuYW1lOiBEQl9OQU1FCiAgICAg\
ICAgZGVzY3JpcHRpb246IE5hbWUgb2YgdGhlIFNRTCBTZXJ2ZXIncyBkYXRhYmFzZQogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IERhdGFi\
YXNlIG5hbWUKICAgICAgLSBuYW1lOiBEQl9TU0wKICAgICAgICBkZXNjcmlwdGlvbjogVXNlIFNT\
TCBjb25uZWN0aW9uIHRvIFNRTCBTZXJ2ZXIKICAgICAgICB0eXBlOiBib29sZWFuCiAgICAgICAg\
ZGlzcGxheV90eXBlOiBjaGVja2JveAogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgdGl0\
bGU6IFVzZSBTU0w/CiAgICBiaW5kX3BhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogQ0xJRU5UX0lE\
CiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICB0aXRsZTogTW9iaWxlIENsaWVudCBJRAog\
ICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIAo="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
