FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHN5bmMtYXBwLWFwYgpkZXNjcmlwdGlvbjogSW5zdGFsbHMgdGhl\
IEFlcm9nZWFyIFN5bmMgQXBwbGljYXRpb24KYmluZGFibGU6IFRydWUKYXN5bmM6IG9wdGlvbmFs\
CnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVkCm1ldGFk\
YXRhOgogIGRpc3BsYXlOYW1lOiBTeW5jIEFwcAogIGNvbnNvbGUub3BlbnNoaWZ0LmlvL2ljb25D\
bGFzczogZmEgZmEtcmVmcmVzaAogICNkb2N1bWVudGF0aW9uVXJsOiAiaHR0cHM6Ly9kb2NzLmFl\
cm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvc3luYy1hcHAuaHRtbCIKICBwcm92aWRlckRpc3BsYXlO\
YW1lOiAiUmVkIEhhdCwgSW5jLiIKICBzZXJ2aWNlTmFtZTogc3luYy1hcHAKcGxhbnM6CiAgLSBu\
YW1lOiBkZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBwbGFuIHNldHMgdXAgdGhlIFN5bmMg\
QXBwbGljYXRpb24KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiAKICAgICAgbW9iaWxlY2xp\
ZW50X2JpbmRfcGFyYW1ldGVyc19kYXRhOgogICAgICAgIC0gJ3t9JwogICAgcGFyYW1ldGVyczoK\
ICAgICAgLSBuYW1lOiBTWU5DX0FQUF9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IFRoZSBuYW1l\
IG9mIHlvdXIgc3luYyBhcHBsaWNhdGlvbi4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBw\
YXR0ZXJuOiAiXlthLXpBLVpfXVthLXpBLVowLTlfXSokIgogICAgICAgIHJlcXVpcmVkOiBUcnVl\
CiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24gTmFtZQogICAgICAtIG5hbWU6IFNZTkNf\
QVBQX0RPQ0tFUl9JTUFHRQogICAgICAgIGRlc2NyaXB0aW9uOiBVUkwgb2YgeW91ciBTeW5jIEFw\
cGxpY2F0aW9uIERvY2tlciBJbWFnZSwgZS5nLiBkb2NrZXIuaW8vYWVyb2dlYXIvdm95YWdlci1z\
ZXJ2ZXItZXhhbXBsZS10YXNrCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6\
IFRydWUKICAgICAgICB0aXRsZTogU3luYyBBcHBsaWNhdGlvbiBEb2NrZXIgaW1hZ2UKICAgICAg\
LSBuYW1lOiBTWU5DX0FQUF9ET0NLRVJfSU1BR0VfVkVSU0lPTgogICAgICAgIGRlc2NyaXB0aW9u\
OiBWZXJzaW9uIG9mIHlvdXIgU3luYyBBcHBsaWNhdGlvbiBEb2NrZXIgSW1hZ2UgKHVzaW5nICds\
YXRlc3QnIGlmIG5vdCBzcGVjaWZpZWQpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVx\
dWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24gRG9ja2VyIGltYWdl\
IHZlcnNpb24KICAgICAgLSBuYW1lOiBTWU5DX0FQUF9IRUFMVEhfRU5EUE9JTlQKICAgICAgICBk\
ZXNjcmlwdGlvbjogSGVhbHRoIEVuZHBvaW50IG9mIHlvdXIgU3luYyBBcHBsaWNhdGlvbiAodXNp\
bmcgJy8nIGlmIG5vdCBzcGVjaWZpZWQpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVx\
dWlyZWQ6IEZhbHNlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwbGljYXRpb24gaGVhbHRoIGVuZHBv\
aW50CiAgICAgIC0gbmFtZTogU1lOQ19BUFBfUE9SVAogICAgICAgIGRlc2NyaXB0aW9uOiBQb3J0\
IG9mIHRoZSBTeW5jIEFwcGxpY2F0aW9uIHRvIEV4cG9zZQogICAgICAgIHR5cGU6IG51bWJlcgog\
ICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFN5bmMgQXBwIFBvcnQKICAgICAg\
LSBuYW1lOiBTWU5DX0FQUF9HUkFQSFFMX0VORFBPSU5UCiAgICAgICAgZGVzY3JpcHRpb246IEdy\
YXBoUUwgRW5kcG9pbnQgb2YgeW91ciBTeW5jIEFwcGxpY2F0aW9uICh1c2luZyAnZ3JhcGhxbCcg\
aWYgbm90IHNwZWNpZmllZCkKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDog\
RmFsc2UKICAgICAgICB0aXRsZTogU3luYyBBcHAgR3JhcGhRTCBFbmRwb2ludAogICAgICAtIG5h\
bWU6IERCX0hPU1ROQU1FCiAgICAgICAgZGVzY3JpcHRpb246IEhvc3RuYW1lIG9mIHRoZSBTUUwg\
U2VydmVyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAg\
ICB0aXRsZTogU1FMIFNlcnZlciBIb3N0bmFtZQogICAgICAtIG5hbWU6IERCX1BPUlQKICAgICAg\
ICBkZXNjcmlwdGlvbjogUG9ydCBvZiB0aGUgU1FMIFNlcnZlcgogICAgICAgIHR5cGU6IG51bWJl\
cgogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIgUG9ydAog\
ICAgICAtIG5hbWU6IERCX1VTRVJOQU1FCiAgICAgICAgZGVzY3JpcHRpb246IFVzZXJuYW1lIHRo\
YXQgd2lsbCBiZSB1c2VkIHRvIGNvbm5lY3QgdG8gRGF0YWJhc2UKICAgICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAgIHRpdGxlOiBTUUwgU2VydmVyIFVzZXJu\
YW1lCiAgICAgIC0gbmFtZTogREJfUEFTU1dPUkQKICAgICAgICBkZXNjcmlwdGlvbjogUGFzc3dv\
cmQgdGhhdCB3aWxsIGJlIHVzZWQgdG8gY29ubmVjdCB0byBEYXRhYmFzZQogICAgICAgIHR5cGU6\
IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IFNRTCBTZXJ2ZXIg\
UGFzc3dvcmQKICAgICAgLSBuYW1lOiBEQl9OQU1FCiAgICAgICAgZGVzY3JpcHRpb246IE5hbWUg\
b2YgdGhlIFNRTCBTZXJ2ZXIncyBkYXRhYmFzZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IHJlcXVpcmVkOiBUcnVlCiAgICAgICAgdGl0bGU6IERhdGFiYXNlIG5hbWUKICAgICAgLSBuYW1l\
OiBEQl9TU0wKICAgICAgICBkZXNjcmlwdGlvbjogVXNlIFNTTCBjb25uZWN0aW9uIHRvIFNRTCBT\
ZXJ2ZXIKICAgICAgICB0eXBlOiBib29sZWFuCiAgICAgICAgZGlzcGxheV90eXBlOiBjaGVja2Jv\
eAogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICAgICAgdGl0bGU6IFVzZSBTU0w/CiAgICBiaW5k\
X3BhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogQ0xJRU5UX0lECiAgICAgICAgcmVxdWlyZWQ6IFRy\
dWUKICAgICAgICB0aXRsZTogTW9iaWxlIENsaWVudCBJRAogICAgICAgIHR5cGU6IHN0cmluZwog\
ICAgICAgIAo="

COPY playbooks /opt/apb/project
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
